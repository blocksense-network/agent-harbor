{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://blocksense.dev/agentfs/control/response.schema.json",
  "title": "AgentFS Control Response",
  "type": "object",
  "oneOf": [
    { "$ref": "#/$defs/Error" },
    { "$ref": "#/$defs/SnapshotCreate" },
    { "$ref": "#/$defs/SnapshotList" },
    { "$ref": "#/$defs/BranchCreate" },
    { "$ref": "#/$defs/BranchBind" }
  ],
  "$defs": {
    "Error": {
      "type": "object",
      "required": ["error"],
      "properties": {
        "error": { "type": "string" },
        "code": { "type": "integer" }
      },
      "additionalProperties": false
    },
    "Snapshot": {
      "type": "object",
      "required": ["id"],
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" }
      },
      "additionalProperties": false
    },
    "Branch": {
      "type": "object",
      "required": ["id"],
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "parent": { "type": "string" }
      },
      "additionalProperties": false
    },
    "SnapshotCreate": {
      "type": "object",
      "required": ["op", "snapshot"],
      "properties": {
        "op": { "const": "snapshot.create" },
        "snapshot": { "$ref": "#/$defs/Snapshot" }
      },
      "additionalProperties": false
    },
    "SnapshotList": {
      "type": "object",
      "required": ["op", "snapshots"],
      "properties": {
        "op": { "const": "snapshot.list" },
        "snapshots": { "type": "array", "items": { "$ref": "#/$defs/Snapshot" } }
      },
      "additionalProperties": false
    },
    "BranchCreate": {
      "type": "object",
      "required": ["op", "branch"],
      "properties": {
        "op": { "const": "branch.create" },
        "branch": { "$ref": "#/$defs/Branch" }
      },
      "additionalProperties": false
    },
    "BranchBind": {
      "type": "object",
      "required": ["op", "branch", "pid"],
      "properties": {
        "op": { "const": "branch.bind" },
        "branch": { "type": "string" },
        "pid": { "type": "integer" }
      },
      "additionalProperties": false
    }
  }
}





